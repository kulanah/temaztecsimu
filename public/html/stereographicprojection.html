<html>
	<head>
		<title>Stereographic Projection</title>
		<style>
			body { margin: 0; }
      canvas { width: 100%; height: 100% }
      #info {
        position: absolute;
        top: 5px;
        left: 5px;
        z-index: 100;
        color: white;
      }
		</style>
	</head>
	<body>
    <div id="info">
      Stereographic Projection<br><br>
      Click to rotate along different axis
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/92/three.min.js"></script>
		<script>
			var scene = new THREE.Scene();
			var camera = new THREE.PerspectiveCamera( 70, window.innerWidth/window.innerHeight, 0.01, 1000 );

			var renderer = new THREE.WebGLRenderer({ antialias: true });
			renderer.setSize( window.innerWidth, window.innerHeight );
			document.body.appendChild( renderer.domElement );

      // Drawing circle based on https://stackoverflow.com/questions/13756112/draw-a-circle-not-shaded-with-three-js
      let radius = 1,
      segments = 64,
      material = new THREE.LineBasicMaterial( { color: 0x00ff88 } ),
      geometry = new THREE.CircleGeometry( radius, segments );

      // Remove center vertex
      geometry.vertices.shift();

      let circles = [];
      for (let i = 0; i < 4; i++){
        for (let j = 0; j < 4; j++){
          let circle = new THREE.LineLoop( geometry, material )
          scene.add(circle);
          circle.rotation.x = Math.PI / 4 * i;
          circle.rotation.y = Math.PI / 4 * j;
          circles.push(circle);
        }
      }

      camera.position.z = 5;
      renderer.render(scene, camera);

      var mouseDown = false;
      document.body.onmousedown = function() { 
        mouseDown = true;
      }
      document.body.onmouseup = function() {
        mouseDown = false;
      }

			var animate = function () {
        requestAnimationFrame( animate );
        for(let circle in circles){
          if(mouseDown){
            circles[circle].rotation.y += .01;
          } else {
            circles[circle].rotation.x += .01;
          }
        }

				renderer.render(scene, camera);
      };

      // Function from https://github.com/mrdoob/three.js/blob/master/examples/webgl_animation_cloth.html
      function onWindowResize() {
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
				renderer.setSize( window.innerWidth, window.innerHeight );
			}

      window.addEventListener( 'resize', onWindowResize, false );

			animate();
		</script>
	</body>
</html>