<!DOCTYPE html>
<html>
<head>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular-sanitize.js"></script>
  <script>
    window.onload = function(event) {
      if(location.search.includes('userquestion')){
        document.getElementById('thanks').style = 'display:block';
      }
    };
  </script>
  <style>
    .highlighted { background: yellow }
    textarea {
      width: 80vw;
      height: 45vh;
    }
    button {
      text-align: center;
    }
  </style>
</head>
<body>
  <div id='thanks' style='display:none'>
      <fieldset id='message'>
          Thank you for your question. <br><br>
          We will email you a response.<br>
      </fieldset><br>
  </div>
  <!--a href='#contact'>Contact Us</a><br><br-->
    <div ng-app="myApp" ng-controller="myCtrl">
      <label> Search: <input ng-model="search.$"></label> <br>
  		<div id="searchObjResults">
  			<div ng-repeat="qa in data | filter:search:strict">
          <p> <strong> Question: </strong>
            <div ng-bind-html="qa.question | highlight:search.$">  {{qa.question}} </div>
          </p>
          <p> <strong> Answer:  </strong>
            <div ng-bind-html="qa.answer | highlight:search.$">  {{qa.answer}} </div>
          </p>
          </div>
  			</div>
  		</div>
  </div>
  <h3 id='contact'>Contact Us</h3>
  <p>
    Didn't find the answer you were looking for? <br>
    Ask us a question using the form below or email us at cemn@pdx.edu.
  </p>
  <form method='post'>
    <textarea id='userquestion' name='userquestion'></textarea><br>
    <div style='text-align: center'>
      <button type='submit'>Submit question</button>
    </div>
  </form>
</body>
<script>
  angular.module('myApp', ['ngSanitize']).controller('myCtrl', function($scope) {
      $scope.data =
        [
            {"question":"What is the difference between field emission and tungsten microscopes?","answer":"Tungsten (or thermionic TEMs), use W wire filaments heated to a high temperature to emit electrons. They have a lower inherent brightness, a larger source size, and a larger energy spread, which limits their ultimate resolving power especially at lower accelerating voltages. Typical magnifications are in the 10s or 100s of times, up to 400,000x. Field emission TEMs (FEGs) use a room temperature emitter in ultra-high vacuum, which can generate an electron beam with a very small size and energy spread. FEG TEMs have very high resolution with useable magnifications up to >900,000x, and maintain high resolution even at very low accelerating voltages."},
            {"question":"What does C<sub>s</sub> mean? C<sub>c</sub>?","answer":"Since the invention of the electron microscope over 60 years ago, the effects of aberrations in electron-magnetic lenses have imposed limits on the performance of SEMs & TEMs. <br><br>C<sub>s</sub> stands for spherical aberration, or the uncertainty in focusing the electrons as a function of how far their trajectory is from the center of the lens. C<sub>c</sub> stands for chromatic aberration, or the uncertainty in focus due to the energy spread and speed of electrons."},
            {"question":"How to set spot size?", "answer":"The condenser lens one convernges electron beam generated by electron gun to a fine electron beam. When pressing L1, the spot size increases one step, the electrical current of C1 lens decreases and focus length become longer, the electron beam diameter is less demagnified."}
        ]
  })  
  .filter('highlight', function($sce) { 
    // hightlight function based on code from https://codeforgeek.com/2014/12/highlight-search-result-angular-filter/
    return function(text, phrase) {
      if (phrase) text = text.replace(new RegExp('('+phrase+')', 'gi'),
        '<span class="highlighted">$1</span>')

      return $sce.trustAsHtml(text)
    }
  });
</script>
</html>